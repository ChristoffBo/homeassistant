<!-- SETTINGS TAB - FIXED -->
    <section id="settings" class="tab-panel">
      <div class="panel-header">
        <div class="panel-title">
          <h1>System Settings</h1>
          <div class="panel-subtitle">Configure Jarvis Prime modules and features</div>
        </div>
      </div>

      <!-- HA Readonly Banner -->
      <div id="settings-readonly-banner" style="display: none; background: rgba(245, 158, 11, 0.15); border: 1px solid rgba(245, 158, 11, 0.4); border-radius: 8px; padding: 16px; margin-bottom: 24px;">
        <div style="display: flex; align-items: center; gap: 12px;">
          <span style="font-size: 24px;">‚ö†Ô∏è</span>
          <div>
            <div style="color: #f59e0b; font-weight: 600; margin-bottom: 4px;">Home Assistant Mode - Read Only</div>
            <div style="color: var(--text-muted); font-size: 14px;">
              Settings are managed through the Home Assistant addon configuration UI. These values are displayed for reference only.
            </div>
          </div>
        </div>
      </div>

      <!-- Settings Sub-tabs - FIXED: Changed settings-tab to orch-tab -->
      <div class="orch-tabs">
        <button class="orch-tab active" data-settings-tab="general">General</button>
        <button class="orch-tab" data-settings-tab="llm">LLM & AI</button>
        <button class="orch-tab" data-settings-tab="personality">Personality</button>
        <button class="orch-tab" data-settings-tab="integrations">Integrations</button>
        <button class="orch-tab" data-settings-tab="communications">Communications</button>
        <button class="orch-tab" data-settings-tab="monitoring">Monitoring</button>
        <button class="orch-tab" data-settings-tab="push">Push Notifications</button>
        <button class="orch-tab" data-settings-tab="sentinel">Sentinel</button>
        <button class="orch-tab" data-settings-tab="backup">Backup & Restore</button>
      </div>

      <!-- GENERAL PANEL -->
      <div id="settings-general-panel" class="settings-panel orch-panel active">
        <div class="panel">
          <div class="panel-head">
            <h3>General Settings</h3>
          </div>
          
          <div style="padding: 20px;">
            <div class="form-group">
              <label class="form-label">Bot Name</label>
              <input type="text" id="set-bot-name" placeholder="Jarvis Prime">
            </div>
            
            <div class="form-group">
              <label class="form-label">Bot Icon</label>
              <input type="text" id="set-bot-icon" placeholder="üß†">
            </div>
            
            <div class="form-group">
              <label class="form-label">Jarvis App Name</label>
              <input type="text" id="set-jarvis-app-name" placeholder="Jarvis">
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-beautify-enabled" />
                <label for="set-beautify-enabled">Enable message beautification</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-beautify-inline-images" />
                <label for="set-beautify-inline-images">Show inline images in messages</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-silent-repost" />
                <label for="set-silent-repost">Silent repost (delete original messages after processing)</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-greeting-enabled" />
                <label for="set-greeting-enabled">Enable greeting messages</label>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Greeting Times (JSON)</label>
              <textarea id="set-greeting-times" rows="3" placeholder='{"morning":"06:00","afternoon":"12:00","evening":"18:00","late_night":"22:30","early_morning":"03:00"}'></textarea>
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                JSON object defining when greetings are sent
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Retention Days</label>
              <input type="number" id="set-retention-days" min="1" placeholder="30">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Number of days to keep messages in inbox
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Retention Hours (for hourly cleanup)</label>
              <input type="number" id="set-retention-hours" min="1" placeholder="24">
            </div>
            
            <div class="form-group">
              <label class="form-label">Auto-Purge Policy</label>
              <select id="set-auto-purge-policy">
                <option value="off">Off</option>
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
              </select>
            </div>
			<div class="form-group">
              <label class="form-label">Cache Refresh Interval (minutes)</label>
              <input type="number" id="set-cache-refresh-minutes" min="1" placeholder="60">
            </div>

          </div>
        </div>
      </div>

      <!-- LLM & AI PANEL -->
      <div id="settings-llm-panel" class="settings-panel orch-panel">
        <div class="panel">
          <div class="panel-head">
            <h3>LLM & AI Configuration</h3>
          </div>
          
          <div style="padding: 20px;">
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-enabled" />
                <label for="set-llm-enabled">Enable LLM processing</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-persona-riffs-enabled" />
                <label for="set-llm-persona-riffs-enabled">Enable persona riffs (personality-based responses)</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-rewrite-enabled" />
                <label for="set-llm-rewrite-enabled">Enable message rewriting</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Models Directory</label>
              <input type="text" id="set-llm-models-dir" placeholder="/share/jarvis_prime/models">
            </div>
            
            <div class="form-group">
              <label class="form-label">Timeout (seconds)</label>
              <input type="number" id="set-llm-timeout-seconds" min="1" placeholder="20">
            </div>
            
            <div class="form-group">
              <label class="form-label">Max CPU %</label>
              <input type="number" id="set-llm-max-cpu-percent" min="1" max="100" placeholder="80">
            </div>
            
            <div class="form-group">
              <label class="form-label">Context Tokens</label>
              <input type="number" id="set-llm-ctx-tokens" min="1" placeholder="6096">
            </div>
            
            <div class="form-group">
              <label class="form-label">Generation Tokens</label>
              <input type="number" id="set-llm-gen-tokens" min="1" placeholder="300">
            </div>
            
            <div class="form-group">
              <label class="form-label">Threads</label>
              <input type="number" id="set-llm-threads" min="1" placeholder="3">
            </div>
            
            <div class="form-group">
              <label class="form-label">Models Priority</label>
              <input type="text" id="set-llm-models-priority" placeholder="phi35_q5_uncensored,phi35_q5,phi35_q4,phi3">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Comma-separated list of model names in priority order
              </div>
            </div>
            
			<div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-cleanup-on-disable" />
                <label for="set-llm-cleanup-on-disable">Cleanup models when LLM is disabled</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Riff Max Tokens</label>
              <input type="number" id="set-llm-riff-max-tokens" min="1" placeholder="32">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Maximum tokens for personality riffs
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Rewrite Max Tokens</label>
              <input type="number" id="set-llm-rewrite-max-tokens" min="1" placeholder="256">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Maximum tokens for message rewriting
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Max Output Lines</label>
              <input type="number" id="set-llm-max-lines" min="1" placeholder="30">
            </div>
            
            <div class="form-group">
              <label class="form-label">System Prompt (optional)</label>
              <textarea id="set-llm-system-prompt" rows="4" placeholder="Custom system prompt for the LLM..."></textarea>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-memory-enabled" />
                <label for="set-llm-memory-enabled">Enable LLM memory/context persistence</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-autodownload" />
                <label for="set-llm-autodownload">Auto-download missing models</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Hugging Face Token (optional)</label>
              <input type="password" id="set-llm-hf-token" placeholder="For private model downloads">
            </div>
            
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Phi-4 Models</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-phi4-q4-enabled" />
                <label for="set-llm-phi4-q4-enabled">Enable Phi-4 Q4 Model</label>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Phi-4 Q4 URL</label>
              <input type="text" id="set-llm-phi4-q4-url" placeholder="https://huggingface.co/...">
            </div>
            <div class="form-group">
              <label class="form-label">Phi-4 Q4 Path</label>
              <input type="text" id="set-llm-phi4-q4-path" placeholder="/share/jarvis_prime/models/phi4-q4.gguf">
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-phi4-q5-enabled" />
                <label for="set-llm-phi4-q5-enabled">Enable Phi-4 Q5 Model</label>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Phi-4 Q5 URL</label>
              <input type="text" id="set-llm-phi4-q5-url" placeholder="https://huggingface.co/...">
            </div>
            <div class="form-group">
              <label class="form-label">Phi-4 Q5 Path</label>
              <input type="text" id="set-llm-phi4-q5-path" placeholder="/share/jarvis_prime/models/phi4-q5.gguf">
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-phi4-q6-enabled" />
                <label for="set-llm-phi4-q6-enabled">Enable Phi-4 Q6 Model</label>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Phi-4 Q6 URL</label>
              <input type="text" id="set-llm-phi4-q6-url" placeholder="https://huggingface.co/...">
            </div>
            <div class="form-group">
              <label class="form-label">Phi-4 Q6 Path</label>
              <input type="text" id="set-llm-phi4-q6-path" placeholder="/share/jarvis_prime/models/phi4-q6.gguf">
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-phi4-q8-enabled" />
                <label for="set-llm-phi4-q8-enabled">Enable Phi-4 Q8 Model</label>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Phi-4 Q8 URL</label>
              <input type="text" id="set-llm-phi4-q8-url" placeholder="https://huggingface.co/...">
            </div>
            <div class="form-group">
              <label class="form-label">Phi-4 Q8 Path</label>
              <input type="text" id="set-llm-phi4-q8-path" placeholder="/share/jarvis_prime/models/phi4-q8.gguf">
            </div>
            
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Phi-3.5 Models</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-phi35-q4-enabled" />
                <label for="set-llm-phi35-q4-enabled">Enable Phi-3.5 Q4 Model</label>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Phi-3.5 Q4 URL</label>
              <input type="text" id="set-llm-phi35-q4-url" placeholder="https://huggingface.co/...">
            </div>
            <div class="form-group">
              <label class="form-label">Phi-3.5 Q4 Path</label>
              <input type="text" id="set-llm-phi35-q4-path" placeholder="/share/jarvis_prime/models/phi35-q4.gguf">
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-phi35-q5-enabled" />
                <label for="set-llm-phi35-q5-enabled">Enable Phi-3.5 Q5 Model</label>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Phi-3.5 Q5 URL</label>
              <input type="text" id="set-llm-phi35-q5-url" placeholder="https://huggingface.co/...">
            </div>
            <div class="form-group">
              <label class="form-label">Phi-3.5 Q5 Path</label>
              <input type="text" id="set-llm-phi35-q5-path" placeholder="/share/jarvis_prime/models/phi35-q5.gguf">
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-phi35-q5-uncensored-enabled" />
                <label for="set-llm-phi35-q5-uncensored-enabled">Enable Phi-3.5 Q5 Uncensored Model</label>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Phi-3.5 Q5 Uncensored URL</label>
              <input type="text" id="set-llm-phi35-q5-uncensored-url" placeholder="https://huggingface.co/...">
            </div>
            <div class="form-group">
              <label class="form-label">Phi-3.5 Q5 Uncensored Path</label>
              <input type="text" id="set-llm-phi35-q5-uncensored-path" placeholder="/share/jarvis_prime/models/phi35-q5-uncensored.gguf">
            </div>
            
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Phi-3 Model</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-phi3-enabled" />
                <label for="set-llm-phi3-enabled">Enable Phi-3 Model</label>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Phi-3 URL</label>
              <input type="text" id="set-llm-phi3-url" placeholder="https://huggingface.co/...">
            </div>
            <div class="form-group">
              <label class="form-label">Phi-3 Path</label>
              <input type="text" id="set-llm-phi3-path" placeholder="/share/jarvis_prime/models/phi3.gguf">
            </div>

			
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">EnviroGuard</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-enviroguard-enabled" />
                <label for="set-llm-enviroguard-enabled">Enable EnviroGuard (temperature-based performance adjustment)</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Poll Interval (minutes)</label>
              <input type="number" id="set-llm-enviroguard-poll-minutes" min="1" placeholder="30">
            </div>
            
            <div class="form-group">
              <label class="form-label">Hot Temperature Threshold (¬∞C)</label>
              <input type="number" id="set-llm-enviroguard-hot-c" placeholder="30">
            </div>
            
            <div class="form-group">
              <label class="form-label">Normal Temperature (¬∞C)</label>
              <input type="number" id="set-llm-enviroguard-normal-c" placeholder="22">
            </div>
            
            <div class="form-group">
              <label class="form-label">Cold Temperature Threshold (¬∞C)</label>
              <input type="number" id="set-llm-enviroguard-cold-c" placeholder="10">
            </div>
			<div class="form-group">
              <label class="form-label">Max Stale Minutes</label>
              <input type="number" id="set-llm-enviroguard-max-stale-minutes" min="1" placeholder="120">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Max time without temperature update before using manual mode
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Hysteresis (¬∞C)</label>
              <input type="number" id="set-llm-enviroguard-hysteresis-c" placeholder="2">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Temperature buffer to prevent rapid switching
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Off Temperature (¬∞C)</label>
              <input type="number" id="set-llm-enviroguard-off-c" placeholder="42">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Temperature threshold to disable LLM completely
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Boost Temperature (¬∞C)</label>
              <input type="number" id="set-llm-enviroguard-boost-c" placeholder="16">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Temperature threshold for boost performance mode
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Performance Profiles (JSON)</label>
              <textarea id="set-llm-enviroguard-profiles" rows="6" placeholder='{"manual":{"cpu_percent":80,"ctx_tokens":4096,"timeout_seconds":20},...}'></textarea>
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Define custom performance profiles for different temperature conditions
              </div>
            </div>
            
            <h5 style="margin-top: 24px; margin-bottom: 12px; color: var(--text-primary); font-size: 14px;">Home Assistant Integration</h5>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-llm-enviroguard-ha-enabled" />
                <label for="set-llm-enviroguard-ha-enabled">Enable Home Assistant temperature sensor</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Home Assistant URL</label>
              <input type="text" id="set-llm-enviroguard-ha-base-url" placeholder="http://homeassistant:8123">
            </div>
            
            <div class="form-group">
              <label class="form-label">Home Assistant Token</label>
              <input type="password" id="set-llm-enviroguard-ha-token" placeholder="Long-lived access token">
            </div>
            
            <div class="form-group">
              <label class="form-label">Temperature Sensor Entity</label>
              <input type="text" id="set-llm-enviroguard-ha-temp-entity" placeholder="sensor.living_room_temperature">
            </div>

          </div>
        </div>
      </div>
      <!-- PERSONALITY PANEL -->
      <div id="settings-personality-panel" class="settings-panel orch-panel">
        <div class="panel">
          <div class="panel-head">
            <h3>Personality Settings</h3>
          </div>
          
          <div style="padding: 20px;">
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-personality-enabled" />
                <label for="set-personality-enabled">Enable personality system</label>
              </div>
            </div>
            
			<div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-personality-persistent" />
                <label for="set-personality-persistent">Persistent personality (remember previous interactions)</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-personality-family-friendly" />
                <label for="set-personality-family-friendly">Family-friendly mode (filter inappropriate content)</label>
              </div>
            </div>

			
            <div class="form-group">
              <label class="form-label">Active Persona</label>
              <select id="set-active-persona">
                <option value="auto">Auto</option>
                <option value="ops">Ops</option>
                <option value="dude">Dude</option>
                <option value="chick">Chick</option>
                <option value="nerd">Nerd</option>
                <option value="rager">Rager</option>
                <option value="comedian">Comedian</option>
                <option value="action">Action</option>
              </select>
            </div>
            
            <div class="form-group">
              <label class="form-label">Min Interval Between Riffs (minutes)</label>
              <input type="number" id="set-personality-min-interval-minutes" min="1" placeholder="90">
            </div>
            
            <div class="form-group">
              <label class="form-label">Interval Jitter %</label>
              <input type="number" id="set-personality-interval-jitter-pct" min="0" max="100" placeholder="20">
            </div>
            
            <div class="form-group">
              <label class="form-label">Daily Max Riffs</label>
              <input type="number" id="set-personality-daily-max" min="1" placeholder="6">
            </div>
            
            <div class="form-group">
              <label class="form-label">Quiet Hours</label>
              <input type="text" id="set-personality-quiet-hours" placeholder="23:00-06:00">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Format: HH:MM-HH:MM (e.g., 23:00-06:00)
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-chat-enabled" />
                <label for="set-chat-enabled">Enable chat functionality</label>
              </div>
            </div>
            
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Enabled Personas</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-enable-dude" />
                <label for="set-enable-dude">Enable Dude persona</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-enable-chick" />
                <label for="set-enable-chick">Enable Chick persona</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-enable-nerd" />
                <label for="set-enable-nerd">Enable Nerd persona</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-enable-rager" />
                <label for="set-enable-rager">Enable Rager persona</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-enable-comedian" />
                <label for="set-enable-comedian">Enable Comedian persona</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-enable-action" />
                <label for="set-enable-action">Enable Action persona</label>
              </div>
            </div>
			<div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-enable-jarvis" />
                <label for="set-enable-jarvis">Enable Jarvis persona</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-enable-ops" />
                <label for="set-enable-ops">Enable Ops persona</label>
              </div>
            </div>

          </div>
        </div>
      </div>

      <!-- INTEGRATIONS PANEL -->
      <div id="settings-integrations-panel" class="settings-panel orch-panel">
        <div class="panel">
          <div class="panel-head">
            <h3>Integration Settings</h3>
          </div>
          
          <div style="padding: 20px;">
            <h4 style="margin-bottom: 16px; color: var(--text-primary);">Weather</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-weather-enabled" />
                <label for="set-weather-enabled">Enable weather reports</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Latitude</label>
              <input type="number" id="set-weather-lat" step="0.0001" placeholder="-26.2041">
            </div>
            
            <div class="form-group">
              <label class="form-label">Longitude</label>
              <input type="number" id="set-weather-lon" step="0.0001" placeholder="28.0473">
            </div>
            
            <div class="form-group">
              <label class="form-label">City Name</label>
              <input type="text" id="set-weather-city" placeholder="Odendaalsrus">
            </div>
            
            <div class="form-group">
              <label class="form-label">Report Time</label>
              <input type="text" id="set-weather-time" placeholder="07:00">
            </div>
			<div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-weather-show-indoor" />
                <label for="set-weather-show-indoor">Show indoor temperature in weather reports</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Indoor Temperature Sensor Entity</label>
              <input type="text" id="set-weather-indoor-sensor-entity" placeholder="sensor.indoor_temperature">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Home Assistant entity ID for indoor temperature
              </div>
            </div>

            
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Daily Digest</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-digest-enabled" />
                <label for="set-digest-enabled">Enable daily digest</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Digest Time</label>
              <input type="text" id="set-digest-time" placeholder="08:00">
            </div>
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-ai-checkins-enabled" />
                <label for="set-ai-checkins-enabled">Enable AI check-ins (proactive notifications)</label>
              </div>
            </div>

            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Heartbeat</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-heartbeat-enabled" />
                <label for="set-heartbeat-enabled">Enable heartbeat messages</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Interval (minutes)</label>
              <input type="number" id="set-heartbeat-interval-minutes" min="1" placeholder="120">
            </div>
            
            <div class="form-group">
              <label class="form-label">Start Time</label>
              <input type="text" id="set-heartbeat-start" placeholder="06:00">
            </div>
            
            <div class="form-group">
              <label class="form-label">End Time</label>
              <input type="text" id="set-heartbeat-end" placeholder="20:00">
            </div>
            
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Radarr</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-radarr-enabled" />
                <label for="set-radarr-enabled">Enable Radarr integration</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Radarr URL</label>
              <input type="text" id="set-radarr-url" placeholder="http://192.168.1.100:7878">
            </div>
            
            <div class="form-group">
              <label class="form-label">API Key</label>
              <input type="text" id="set-radarr-api-key" placeholder="Enter API key">
            </div>
            
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Sonarr</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-sonarr-enabled" />
                <label for="set-sonarr-enabled">Enable Sonarr integration</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Sonarr URL</label>
              <input type="text" id="set-sonarr-url" placeholder="http://192.168.1.100:8989">
            </div>
            
            <div class="form-group">
              <label class="form-label">API Key</label>
              <input type="text" id="set-sonarr-api-key" placeholder="Enter API key">
            </div>
          </div>
        </div>
      </div>

      <!-- COMMUNICATIONS PANEL -->
      <div id="settings-communications-panel" class="settings-panel orch-panel">
        <div class="panel">
          <div class="panel-head">
            <h3>Communication Channels</h3>
          </div>
          
          <div style="padding: 20px;">
            <h4 style="margin-bottom: 16px; color: var(--text-primary);">SMTP Intake</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-smtp-enabled" />
                <label for="set-smtp-enabled">Enable SMTP server</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">SMTP Port</label>
              <input type="number" id="set-smtp-port" min="1" placeholder="2525">
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-ingest-smtp-enabled" />
                <label for="set-ingest-smtp-enabled">Enable SMTP message ingestion</label>
              </div>
            </div>
            <h4 style="margin-bottom: 16px; color: var(--text-primary);">SMTP Intake Server</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-smtp-enabled" />
                <label for="set-smtp-enabled">Enable SMTP server</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Bind Address</label>
              <input type="text" id="set-smtp-bind" placeholder="0.0.0.0">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Network interface to bind to (0.0.0.0 = all interfaces)
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">SMTP Port</label>
              <input type="number" id="set-smtp-port" min="1" placeholder="2525">
            </div>
            
            <div class="form-group">
              <label class="form-label">Max Message Size (bytes)</label>
              <input type="number" id="set-smtp-max-bytes" min="1" placeholder="262144">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Maximum email size (262144 = 256KB)
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Dummy Recipient</label>
              <input type="text" id="set-smtp-dummy-rcpt" placeholder="alerts@jarvis.local">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Accept emails to any address (this is just a placeholder)
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-smtp-accept-any-auth" />
                <label for="set-smtp-accept-any-auth">Accept any authentication (no password checking)</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Title Prefix</label>
              <input type="text" id="set-smtp-rewrite-title-prefix" placeholder="[SMTP]">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Prefix added to subject lines of SMTP messages
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-smtp-allow-html" />
                <label for="set-smtp-allow-html">Allow HTML emails</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Default Priority</label>
              <input type="number" id="set-smtp-priority-default" min="1" max="10" placeholder="5">
            </div>
            
            <div class="form-group">
              <label class="form-label">Priority Map (JSON)</label>
              <textarea id="set-smtp-priority-map" rows="3" placeholder='{"high": 7, "urgent": 8, "critical": 9, "low": 3, "normal": 5}'></textarea>
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Map keywords in subject/body to priority levels
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-ingest-smtp-enabled" />
                <label for="set-ingest-smtp-enabled">Enable SMTP message ingestion</label>
              </div>
            </div>

            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Notification Proxy</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-proxy-enabled" />
                <label for="set-proxy-enabled">Enable proxy intake</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Bind Address</label>
              <input type="text" id="set-proxy-bind" placeholder="0.0.0.0">
            </div>
            
            <div class="form-group">
              <label class="form-label">Proxy Port</label>
              <input type="number" id="set-proxy-port" min="1" placeholder="2580">
            </div>
            
            <div class="form-group">
              <label class="form-label">Gotify Proxy URL</label>
              <input type="text" id="set-proxy-gotify-url" placeholder="http://10.0.0.99:8091">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Gotify server to proxy messages to
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">ntfy Proxy URL</label>
              <input type="text" id="set-proxy-ntfy-url" placeholder="http://10.0.0.99:8080">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                ntfy server to proxy messages to
              </div>
            </div>

            
            <div class="form-group">
              <label class="form-label">Proxy Port</label>
              <input type="number" id="set-proxy-port" min="1" placeholder="2580">
            </div>
            
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Webhook Intake</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-webhook-enabled" />
                <label for="set-webhook-enabled">Enable webhook intake</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Bind Address</label>
              <input type="text" id="set-webhook-bind" placeholder="0.0.0.0">
            </div>
            
            <div class="form-group">
              <label class="form-label">Webhook Port</label>
              <input type="number" id="set-webhook-port" min="1" placeholder="2590">
            </div>
            
            <div class="form-group">
              <label class="form-label">Webhook Token (optional)</label>
              <input type="password" id="set-webhook-token" placeholder="Leave blank to accept all requests">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Token for webhook authentication (optional)
              </div>
            </div>

            
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Apprise Server</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-intake-apprise-enabled" />
                <label for="set-intake-apprise-enabled">Enable Apprise intake server</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Apprise Port</label>
              <input type="number" id="set-intake-apprise-port" min="1" placeholder="2591">
            </div>
            
            <div class="form-group">
              <label class="form-label">Apprise Token</label>
              <input type="password" id="set-intake-apprise-token" placeholder="change-me-very-long">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Authentication token for Apprise API
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-intake-apprise-accept-any-key" />
                <label for="set-intake-apprise-accept-any-key">Accept any key (no key validation)</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Allowed Keys (comma-separated)</label>
              <input type="text" id="set-intake-apprise-allowed-keys" placeholder="key1,key2,key3">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Only used if "accept any key" is disabled
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-ingest-apprise-enabled" />
                <label for="set-ingest-apprise-enabled">Enable Apprise message ingestion</label>
              </div>
            </div>
           <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">WebSocket Intake</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-intake-ws-enabled" />
                <label for="set-intake-ws-enabled">Enable WebSocket intake</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">WebSocket Port</label>
              <input type="number" id="set-intake-ws-port" min="1" placeholder="8765">
            </div>
            
            <div class="form-group">
              <label class="form-label">WebSocket Token</label>
              <input type="password" id="set-intake-ws-token" placeholder="change-me-very-long">
            </div>

          </div>
        </div>
      </div>

      <!-- MONITORING PANEL -->
      <div id="settings-monitoring-panel" class="settings-panel orch-panel">
        <div class="panel">
          <div class="panel-head">
            <h3>Monitoring Services</h3>
          </div>
          
          <div style="padding: 20px;">
            <h4 style="margin-bottom: 16px; color: var(--text-primary);">Uptime Kuma</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-uptimekuma-enabled" />
                <label for="set-uptimekuma-enabled">Enable Uptime Kuma integration</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Uptime Kuma URL</label>
              <input type="text" id="set-uptimekuma-url" placeholder="http://192.168.1.100:3001">
            </div>
            
            <div class="form-group">
              <label class="form-label">API Key</label>
              <input type="text" id="set-uptimekuma-api-key" placeholder="Enter API key">
            </div>
            <div class="form-group">
              <label class="form-label">Status Page Slug (optional)</label>
              <input type="text" id="set-uptimekuma-status-slug" placeholder="my-status-page">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Slug for public status page
              </div>
            </div>

            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">Technitium DNS</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-technitium-enabled" />
                <label for="set-technitium-enabled">Enable Technitium DNS integration</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Technitium URL</label>
              <input type="text" id="set-technitium-url" placeholder="http://192.168.1.100:5380">
            </div>
            
            <div class="form-group">
              <label class="form-label">API Key</label>
              <input type="text" id="set-technitium-api-key" placeholder="Enter API key">
            </div>
			<div class="form-group">
              <label class="form-label">Username</label>
              <input type="text" id="set-technitium-user" placeholder="admin">
            </div>
            
            <div class="form-group">
              <label class="form-label">Password</label>
              <input type="password" id="set-technitium-pass" placeholder="Enter password">
            </div>

          </div>
        </div>
      </div>
     <!-- PUSH NOTIFICATIONS PANEL -->
      <div id="settings-push-panel" class="settings-panel orch-panel">
        <div class="panel">
          <div class="panel-head">
            <h3>Push Notification Services</h3>
          </div>
          
          <div style="padding: 20px;">
            <h4 style="margin-bottom: 16px; color: var(--text-primary);">Gotify</h4>
            
            <div class="form-group">
              <label class="form-label">Gotify URL</label>
              <input type="text" id="set-gotify-url" placeholder="http://192.168.1.100:8091">
            </div>
            
            <div class="form-group">
              <label class="form-label">Client Token</label>
              <input type="text" id="set-gotify-client-token" placeholder="Enter client token">
            </div>
            
            <div class="form-group">
              <label class="form-label">App Token</label>
              <input type="text" id="set-gotify-app-token" placeholder="Enter app token">
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-push-gotify-enabled" />
                <label for="set-push-gotify-enabled">Enable Gotify push notifications</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-ingest-gotify-enabled" />
                <label for="set-ingest-gotify-enabled">Enable Gotify message ingestion</label>
              </div>
            </div>
            
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">ntfy</h4>
            
            <div class="form-group">
              <label class="form-label">ntfy URL</label>
              <input type="text" id="set-ntfy-url" placeholder="http://192.168.1.100:8080">
            </div>
            
            <div class="form-group">
              <label class="form-label">ntfy Topic</label>
              <input type="text" id="set-ntfy-topic" placeholder="jarvis">
            </div>
            
            <div class="form-group">
              <label class="form-label">ntfy Username (optional)</label>
              <input type="text" id="set-ntfy-user" placeholder="For authenticated servers">
            </div>
            
            <div class="form-group">
              <label class="form-label">ntfy Password (optional)</label>
              <input type="password" id="set-ntfy-pass" placeholder="Password">
            </div>
            
            <div class="form-group">
              <label class="form-label">ntfy Token (alternative)</label>
              <input type="password" id="set-ntfy-token" placeholder="Authentication token">
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-push-ntfy-enabled" />
                <label for="set-push-ntfy-enabled">Enable ntfy push notifications</label>
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-ingest-ntfy-enabled" />
                <label for="set-ingest-ntfy-enabled">Enable ntfy message ingestion</label>
              </div>
            </div>
            <h4 style="margin-top: 32px; margin-bottom: 16px; color: var(--text-primary);">SMTP Email Notifications</h4>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-push-smtp-enabled" />
                <label for="set-push-smtp-enabled">Enable SMTP email notifications</label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">SMTP Host</label>
              <input type="text" id="set-push-smtp-host" placeholder="smtp.gmail.com">
            </div>
            
            <div class="form-group">
              <label class="form-label">SMTP Port</label>
              <input type="number" id="set-push-smtp-port" min="1" placeholder="587">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Common ports: 25, 465 (SSL), 587 (TLS)
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">SMTP Username</label>
              <input type="text" id="set-push-smtp-user" placeholder="your-email@gmail.com">
            </div>
            
            <div class="form-group">
              <label class="form-label">SMTP Password</label>
              <input type="password" id="set-push-smtp-pass" placeholder="App password">
            </div>
            
            <div class="form-group">
              <label class="form-label">Send To Email</label>
              <input type="email" id="set-push-smtp-to" placeholder="recipient@example.com">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Email address to receive notifications
              </div>
            </div>

			
          </div>
        </div>
      </div>

      <!-- NEW: BACKUP & RESTORE PANEL -->
      <div id="settings-backup-panel" class="settings-panel orch-panel">
        <div class="panel">
          <div class="panel-head">
            <h3>Backup & Restore</h3>
          </div>
          
          <div style="padding: 20px;">
            <div style="background: rgba(14, 165, 233, 0.1); border: 1px solid rgba(14, 165, 233, 0.3); border-radius: 8px; padding: 16px; margin-bottom: 24px;">
              <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                <span style="font-size: 24px;">üíæ</span>
                <span style="color: #0ea5e9; font-weight: 600;">Full System Backup</span>
              </div>
              <p style="color: var(--text-muted); font-size: 13px; margin-bottom: 0;">
                Create a complete backup of your Jarvis Prime installation including database, playbooks, models, and configuration.
              </p>
            </div>
            
            <div style="margin-bottom: 32px;">
              <h4 style="margin: 0 0 12px 0; color: var(--text-primary);">Create Backup</h4>
              <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 16px;">
                Download a complete backup archive (.tar.gz) containing all system data.
              </p>
              <button id="backup-download-btn" class="btn primary" style="width: 100%;">
                üì• Download Full Backup
              </button>
            </div>
            
            <div style="padding-top: 24px; border-top: 1px solid var(--surface-border);">
              <h4 style="margin: 0 0 12px 0; color: var(--text-primary);">Restore Backup</h4>
              <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 16px;">
                Upload a backup archive to restore your system. <strong style="color: var(--accent-primary);">This will overwrite all current data.</strong>
              </p>
              
              <div style="background: rgba(245, 158, 11, 0.15); border: 1px solid rgba(245, 158, 11, 0.4); border-radius: 6px; padding: 12px; margin-bottom: 16px;">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <span style="font-size: 18px;">‚ö†Ô∏è</span>
                  <span style="color: #f59e0b; font-size: 13px; font-weight: 500;">
                    Jarvis will automatically restart after restore completes
                  </span>
                </div>
              </div>
              
              <input type="file" id="backup-file-input" accept=".tar.gz,.tgz" style="display: none;">
              <button id="backup-restore-btn" class="btn" style="width: 100%;">
                üì§ Select Backup File to Restore
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- SENTINEL SETTINGS PANEL -->
      <div id="settings-sentinel-panel" class="settings-panel orch-panel">
        <div class="panel">
          <div class="panel-head">
            <h3>Sentinel Configuration</h3>
          </div>
          
          <div style="padding: 20px;">
            <div style="background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 8px; padding: 16px; margin-bottom: 24px;">
              <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                <span style="font-size: 24px;">üõ†Ô∏è</span>
                <span style="color: #8b5cf6; font-weight: 600;">Autonomous Service Monitoring</span>
              </div>
              <p style="color: var(--text-muted); font-size: 13px; margin-bottom: 0;">
                Configure Sentinel's automated monitoring and self-healing capabilities
              </p>
            </div>
            
            <h4 style="margin: 24px 0 16px 0; color: var(--text-primary);">Template Repository</h4>
            
            <div class="form-group">
              <label class="form-label">GitHub Repository URL</label>
              <input type="text" id="set-sentinel-github-url" placeholder="https://github.com/username/repo">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                URL to GitHub repository containing service check templates. Used when syncing templates.
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label">Templates Path (in repo)</label>
              <input type="text" id="set-sentinel-github-path" placeholder="templates/" value="templates/">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Path within repository where .json template files are stored
              </div>
            </div>
            
            <h4 style="margin: 32px 0 16px 0; color: var(--text-primary);">Monitoring Schedule</h4>
            
            <div class="form-group">
              <label class="form-label">Quiet Hours</label>
              <input type="text" id="set-sentinel-quiet-hours" placeholder="23:00-06:00">
              <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                Time range when Sentinel will suppress non-critical alerts (format: HH:MM-HH:MM)
              </div>
            </div>
            
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="set-sentinel-quiet-enabled" />
                <label for="set-sentinel-quiet-enabled">Enable quiet hours</label>
              </div>
            </div>
            
            <h4 style="margin: 32px 0 16px 0; color: var(--text-primary);">Statistics & Data</h4>
            
            <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; padding: 16px;">
              <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                <span style="font-size: 24px;">‚ö†Ô∏è</span>
                <span style="color: #ef4444; font-weight: 600;">Reset Statistics</span>
              </div>
              <p style="color: var(--text-muted); font-size: 13px; margin-bottom: 12px;">
                Reset all Sentinel dashboard statistics (total checks, repairs made, etc.) to zero. Execution history will be preserved.
              </p>
              <button id="sentinel-reset-stats-btn" class="btn danger" style="width: 100%;" onclick="sentinelResetStats()">
                üóëÔ∏è Reset All Statistics
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Save Button (only visible in Docker mode) -->
      <div style="margin-top: 24px; padding: 20px; background: var(--surface-secondary); border-radius: 8px; display: flex; justify-content: flex-end; gap: 12px;">
        <button id="settings-save-btn" class="btn primary" onclick="settingsSaveConfig()">Save Settings</button>
      </div>
    </section>