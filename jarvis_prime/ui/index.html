<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jarvis Prime â€” Inbox v4.11</title>
  <!-- Robust dynamic base: use the directory of the current URL, not the full pathname -->
  <script>
    (function(){
      var path = location.pathname;
      var dir  = path.endsWith('/') ? path : path.replace(/[^\/]*$/, '');
      if (!dir.endsWith('/')) dir += '/';
      document.write('<base href="' + dir + '">');
    })();
  </script>
  <link rel="icon" href="icon.png" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<header class="topbar">
  <div class="brand">
    <img src="icon.png" alt="Jarvis" class="logo" />
    <div class="titles">
      <h1>Jarvis Prime</h1>
      <div class="subtitle">
        Unified Inbox â€¢ <span id="live-badge" class="live err">OFFLINE</span> â€¢ v4.11
      </div>
    </div>
  </div>
  <div class="ask">
    <div class="ask-row">
      <input id="wake-text" type="text" placeholder="Ask Jarvisâ€¦ e.g., weather" />
      <button id="wake-send" class="btn primary">Send</button>
      <button id="btn-refresh" class="btn">Refresh</button>
    </div>
    <div class="chips">
      <button class="chip" data-wake="weather">Weather</button>
      <button class="chip" data-wake="status">Status</button>
      <button class="chip" data-wake="help">Help</button>
      <label class="chip toggle"><input id="chime" type="checkbox" /> Sound</label>
    </div>
  </div>
</header>

<section class="pulse" id="pulse">
  <div class="pulse-card"><div class="k">All</div><div class="v" id="c-all">0</div></div>
  <div class="pulse-card"><div class="k">Unread</div><div class="v" id="c-unread">0</div></div>
  <div class="pulse-card"><div class="k">Archived</div><div class="v" id="c-arch">0</div></div>
  <div class="pulse-card"><div class="k">SMTP</div><div class="v" id="c-smtp">0</div></div>
  <div class="pulse-card"><div class="k">Gotify</div><div class="v" id="c-gotify">0</div></div>
  <div class="pulse-card"><div class="k">UI</div><div class="v" id="c-ui">0</div></div>
</section>

<section class="toolbar">
  <div class="search">
    <div class="search-wrap">
      <span>ðŸ”Ž</span>
      <input id="q" type="search" placeholder="Search title, body, sourceâ€¦" />
    </div>
    <div class="controls">
      <label>Limit
        <select id="limit">
          <option>25</option><option selected>50</option><option>100</option><option>200</option>
        </select>
      </label>
      <label>Retention
        <select id="retention"><option>7</option><option>14</option><option selected>30</option><option>60</option><option>90</option></select>
        <button id="btn-save-retention" class="btn">Save</button>
      </label>
      <label>Purge
        <select id="purge-days"><option>7</option><option>14</option><option selected>30</option><option>60</option><option>90</option><option value="custom">Customâ€¦</option></select>
        <button id="btn-purge" class="btn danger">Run</button>
      </label>
      <label class="inline">
        <input id="keep-arch" type="checkbox" checked/> Keep archived
      </label>
      <button id="btn-delall" class="btn danger">Delete all</button>
      <button id="btn-search" class="btn primary">Search</button>
    </div>
  </div>
</section>

<main class="grid">
  <aside class="rail" data-area="rail" id="rail">
    <div>
      <div class="tabs">
        <button class="tab active" data-tab="all">All</button>
        <button class="tab" data-tab="unread">Unread</button>
        <button class="tab" data-tab="archived">Archived</button>
        <button class="tab" data-tab="errors">Errors</button>
      </div>
      <div class="sources">
        <div class="label">Sources</div>
        <button class="chip" data-src="">Any</button>
        <button class="chip" data-src="smtp">SMTP</button>
        <button class="chip" data-src="gotify">Gotify</button>
        <button class="chip" data-src="ui">UI</button>
      </div>
    </div>

    <!-- Bottom rail action -->
    <div class="rail-bottom">
      <button id="rail-delall" class="btn danger">ðŸ—‘ Delete All</button>
    </div>
  </aside>

  <section class="detail" id="detail" data-area="detail">
    <div class="empty">
      <h2>Inbox</h2>
      <p>No message selected.</p>
    </div>
  </section>

  <section class="feed" id="feed" data-area="feed"></section>

  <section class="detail-ghost" style="display:none"></section>
    <div class="empty">
      <h2>Inbox</h2>
      <p>No message selected.</p>
    </div>
  </section>
</main>

<div id="toast"></div>
<audio id="ding"><source src="data:audio/mp3;base64,//uQZAAAAAAAAAAAAAAAAAAAA..." type="audio/mp3"></audio>

<footer class="footer" id="footer"></footer>

<script src="app.js"></script>
</body>
</html>