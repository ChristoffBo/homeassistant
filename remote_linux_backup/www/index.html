<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Remote Linux Backup</title>
  <link rel="stylesheet" href="/www/style.css" />
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="brand">
        <div class="brand__logo" aria-hidden="true"></div>
        <div>
          <h1 class="brand__title">Remote Linux Backup</h1>
          <p class="brand__subtitle">Back up &amp; restore remote Linux (dd, rsync, ZFS) with NAS mounts, Dropbox, scheduler &amp; Gotify.</p>
        </div>
      </div>
      <nav class="tabs" role="tablist" aria-label="Sections">
        <button class="tab is-active" data-tab="backup" role="tab" aria-selected="true">Backup</button>
        <button class="tab" data-tab="restore" role="tab">Restore</button>
        <button class="tab" data-tab="jobs" role="tab">Jobs</button>
        <button class="tab" data-tab="settings" role="tab">Settings</button>
      </nav>
    </header>

    <!-- BACKUP -->
    <section id="backup" class="panel is-active" role="tabpanel" aria-labelledby="Backup">
      <div class="grid">
        <div class="field">
          <label>Host/IP <span class="hint">Remote server to back up</span></label>
          <input id="b-host" placeholder="10.0.0.21" />
        </div>
        <div class="field">
          <label>User <span class="hint">SSH username</span></label>
          <input id="b-user" value="root" />
        </div>
        <div class="field">
          <label>Password <span class="hint">SSH password (no keys required)</span></label>
          <input id="b-pass" type="password" />
        </div>
        <div class="field">
          <label>Method <span class="hint">dd = full disk image; rsync = files; ZFS = snapshot</span></label>
          <select id="b-method">
            <option value="dd">Full Disk (dd)</option>
            <option value="rsync">Files (rsync)</option>
            <option value="zfs">ZFS Snapshot</option>
          </select>
        </div>

        <div class="field" id="b-disk-wrap">
          <label>Disk device <span class="hint">Only for dd</span></label>
          <input id="b-disk" value="/dev/sda" />
        </div>
        <div class="field hide" id="b-files-wrap">
          <label>Paths (comma separated) <span class="hint">Only for rsync</span></label>
          <input id="b-files" value="/etc,/var/backups" />
        </div>
        <div class="field hide" id="b-zfs-wrap">
          <label>ZFS dataset <span class="hint">e.g. rpool/ROOT/pve-1</span></label>
          <input id="b-zfs" placeholder="tank/data" />
        </div>

        <div class="field">
          <label>Store to (local/NAS path) <span class="hint">Where images/files are saved inside the add-on</span></label>
          <input id="b-store" value="/backup" />
        </div>
        <div class="field">
          <label>Dropbox remote (optional) <span class="hint">rclone remote, e.g. dropbox:/HA-Backups/Proxmox</span></label>
          <input id="b-cloud" placeholder="dropbox:/HA-Backups/Proxmox" />
        </div>
      </div>

      <div class="actions">
        <button id="btn-probe" class="btn">Probe host</button>
        <button id="btn-tools" class="btn">Auto-install tools</button>
        <button id="btn-backup" class="btn btn--primary">Run backup</button>
      </div>

      <div class="log-wrap">
        <div class="log-title">Result</div>
        <pre id="backup-log" class="log" aria-live="polite"></pre>
      </div>
    </section>

    <!-- RESTORE -->
    <section id="restore" class="panel" role="tabpanel" aria-labelledby="Restore">
      <div class="grid">
        <div class="field">
          <label>Host/IP <span class="hint">Remote server to restore to</span></label>
          <input id="r-host" placeholder="10.0.0.21" />
        </div>
        <div class="field">
          <label>User</label>
          <input id="r-user" value="root" />
        </div>
        <div class="field">
          <label>Password</label>
          <input id="r-pass" type="password" />
        </div>
        <div class="field">
          <label>Method</label>
          <select id="r-method">
            <option value="dd">Restore Disk (dd)</option>
            <option value="rsync">Restore Files (rsync)</option>
          </select>
        </div>

        <div class="field" id="r-image-wrap">
          <label>Image path (.img.gz) <span class="hint">For dd restore</span></label>
          <input id="r-image" placeholder="/mnt/nas/proxmox-20250101.img.gz" />
        </div>
        <div class="field" id="r-disk-wrap">
          <label>Disk device <span class="hint">Target device on remote host</span></label>
          <input id="r-disk" value="/dev/sda" />
        </div>
        <div class="field hide" id="r-src-wrap">
          <label>Local source dir <span class="hint">Folder inside the add-on to push via rsync</span></label>
          <input id="r-src" placeholder="/backup/opnsense" />
        </div>
        <div class="field hide" id="r-dest-wrap">
          <label>Remote destination <span class="hint">Path on the remote host</span></label>
          <input id="r-dest" value="/" />
        </div>
      </div>

      <div class="actions">
        <button id="btn-run-restore" class="btn btn--primary">Run restore</button>
      </div>

      <div class="log-wrap">
        <div class="log-title">Result</div>
        <pre id="restore-log" class="log" aria-live="polite"></pre>
      </div>
    </section>

    <!-- JOBS -->
    <section id="jobs" class="panel" role="tabpanel" aria-labelledby="Jobs">
      <p class="help">
        <strong>Jobs</strong> run on a schedule (cron). Each line can be either JSON or simple
        <code>key=value;key=value</code>. Required: <code>host</code>, <code>username</code>, <code>password</code>, <code>method</code>, <code>schedule</code>.
      </p>
      <details class="help details">
        <summary>Examples</summary>
        <pre class="code">
#