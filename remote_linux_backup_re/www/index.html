<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Remote Linux Backup — Control Panel</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img src="logo.png" alt="Logo" class="logo"/>
      <div>
        <div class="title">Remote Linux Backup</div>
        <div class="subtitle">Back up and restore Linux hosts • Fast • Clear • Safe</div>
      </div>
    </div>
    <div class="status-area">
      <span id="apiStatus" class="status-dot offline" title="API status"></span>
      <button id="refreshBtn" class="btn ghost" title="Refresh data">Refresh</button>
    </div>
  </header>

  <main class="container">
    <nav class="tabs" role="tablist" aria-label="Main">
      <button class="tab active" data-tab="backup" role="tab" aria-selected="true">Backup</button>
      <button class="tab" data-tab="restore" role="tab" aria-selected="false">Restore</button>
      <button class="tab" data-tab="scheduler" role="tab" aria-selected="false">Scheduler</button>
      <button class="tab" data-tab="settings" role="tab" aria-selected="false">Settings</button>
      <button class="tab" data-tab="logs" role="tab" aria-selected="false">Logs</button>
    </nav>

    <!-- Backup -->
    <section id="tab-backup" class="tabpanel active" role="tabpanel">
      <div class="grid two">
        <div class="card">
          <div class="card-head">
            <h2>Source (what to back up)</h2>
            <span class="help" title="Choose the machine and path to back up. Use 'Folder / Files' for directories; use 'Full disk image' to copy an entire device with dd.">?</span>
          </div>
          <div class="form-grid">
            <label>Host
              <select id="bkSrcHost"></select>
            </label>
            <label>Backup type
              <select id="bkType">
                <option value="rsync">Folder / Files (rsync/tar)</option>
                <option value="dd">Full disk image (dd)</option>
              </select>
            </label>
            <label id="bkPathLabel">Path (folder or file)
              <input id="bkSrcPath" type="text" placeholder="/etc /var/lib/docker or /dev/sda" />
            </label>
            <label>Compression
              <select id="bkCompression">
                <option value="auto">Auto</option>
                <option value="gzip">gzip (.gz)</option>
                <option value="xz">xz (.xz)</option>
                <option value="none">None</option>
              </select>
            </label>
          </div>
        </div>

        <div class="card">
          <div class="card-head">
            <h2>Destination (where to store)</h2>
            <span class="help" title="Store to a NAS path or Dropbox. For Dropbox, authenticate then choose a folder.">?</span>
          </div>
          <div class="form-grid">
            <label>Destination
              <select id="bkDestType">
                <option value="path">Local/NAS path</option>
                <option value="dropbox">Dropbox</option>
              </select>
            </label>
            <label id="bkDestPathWrap">Target path (NAS)
              <input id="bkDestPath" type="text" placeholder="/mnt/nas/backups/server1" />
            </label>
            <div id="bkDropboxWrap" class="row hidden">
              <button id="bkConnectDropbox" class="btn">Connect Dropbox</button>
              <input id="bkDropboxFolder" class="grow" type="text" placeholder="/HA-Backups" />
              <button id="bkPickDropbox" class="btn ghost">Pick Folder</button>
            </div>
            <label>Name (optional)
              <input id="bkName" type="text" placeholder="auto if empty" />
            </label>
          </div>
          <div class="actions">
            <button id="startBackup" class="btn primary">Start Backup</button>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-head">
          <h2>Existing Backups</h2>
          <span class="help" title="Click a backup to restore; you will be asked where to restore to.">?</span>
        </div>
        <div id="backupsTable" class="table"></div>
      </div>
    </section>

    <!-- Restore -->
    <section id="tab-restore" class="tabpanel" role="tabpanel">
      <div class="card">
        <div class="card-head">
          <h2>Restore</h2>
          <span class="help" title="Pick a backup and a restore target">?</span>
        </div>
        <div class="form-grid three">
          <label>Backup
            <select id="rsBackupSelect"></select>
          </label>
          <label>Restore to host
            <select id="rsTargetHost"></select>
          </label>
          <label>Restore path / device
            <input id="rsTargetPath" type="text" placeholder="/restore/path or /dev/sda" />
          </label>
        </div>
        <div class="actions">
          <button id="startRestore" class="btn danger">Start Restore</button>
        </div>
      </div>
    </section>

    <!-- Scheduler -->
    <section id="tab-scheduler" class="tabpanel" role="tabpanel">
      <div class="grid two">
        <div class="card">
          <div class="card-head">
            <h2>New Scheduled Job</h2>
            <span class="help" title="Create an automatic backup job.">?</span>
          </div>
          <div class="form-grid two">
            <label>Job name
              <input id="scName" type="text" placeholder="weekly-server1-home" />
            </label>
            <label>Type
              <select id="scType">
                <option value="rsync">Folder / Files (rsync/tar)</option>
                <option value="dd">Full disk image (dd)</option>
              </select>
            </label>
            <label>Source host
              <select id="scSrcHost"></select>
            </label>
            <label>Source path / device
              <input id="scSrcPath" type="text" placeholder="/home or /dev/sda" />
            </label>
            <label>Destination
              <select id="scDestType">
                <option value="path">Local/NAS path</option>
                <option value="dropbox">Dropbox</option>
              </select>
            </label>
            <label id="scDestPathLabel">Target path (NAS)
              <input id="scDestPath" type="text" placeholder="/mnt/nas/backups/server1" />
            </label>
            <div id="scDropboxWrap" class="row hidden">
              <input id="scDropboxFolder" class="grow" type="text" placeholder="/HA-Backups" />
              <button id="scPickDropbox" class="btn ghost">Pick</button>
            </div>
          </div>

          <div class="divider"></div>

          <div class="form-grid three">
            <label>Schedule
              <select id="scMode">
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
                <option value="once">One time</option>
                <option value="cron">Cron</option>
              </select>
            </label>
            <label id="scWeeklyWrap">Weekday
              <select id="scWeekday">
                <option value="0">Sunday</option>
                <option value="1">Monday</option>
                <option value="2">Tuesday</option>
                <option value="3">Wednesday</option>
                <option value="4">Thursday</option>
                <option value="5">Friday</option>
                <option value="6">Saturday</option>
              </select>
            </label>
            <label id="scMonthlyWrap">Month day
              <input id="scMonthday" type="number" min="1" max="31" value="1" />
            </label>
            <label id="scTimeWrap">Time
              <input id="scTime" type="time" value="02:00" />
            </label>
            <label id="scOnceWrap" class="hidden">Date/time
              <input id="scOnceDateTime" type="datetime-local" />
            </label>
            <label id="scCronWrap" class="hidden">Cron
              <input id="scCron" type="text" placeholder="0 2 * * 6" />
            </label>
          </div>
          <div class="actions">
            <button id="scCreate" class="btn primary">Create Job</button>
          </div>
        </div>

        <div class="card">
          <div class="card-head">
            <h2>Scheduled Jobs</h2>
          </div>
          <div id="jobsTable" class="table"></div>
        </div>
      </div>
    </section>

    <!-- Settings -->
    <section id="tab-settings" class="tabpanel" role="tabpanel">
      <div class="grid two">
        <div class="card">
          <div class="card-head"><h2>Hosts</h2></div>
          <div class="form-grid three">
            <label>Host label
              <input id="hLabel" type="text" placeholder="Server 1" />
            </label>
            <label>Address
              <input id="hAddr" type="text" placeholder="10.0.0.10" />
            </label>
            <label>User
              <input id="hUser" type="text" placeholder="root" />
            </label>
            <label>Password
              <input id="hPass" type="password" placeholder="password" />
            </label>
            <label>Default path
              <input id="hPath" type="text" placeholder="/mnt/data" />
            </label>
            <div class="actions">
              <button id="hAdd" class="btn">Add/Update</button>
              <button id="hTest" class="btn ghost">Test SSH</button>
            </div>
          </div>
          <div id="hostsTable" class="table"></div>
        </div>

        <div class="card">
          <div class="card-head"><h2>Integrations</h2></div>
          <div class="form-grid two">
            <label>Dropbox token
              <input id="setDropboxToken" type="password" placeholder="Paste OAuth token" />
            </label>
            <label>Default Dropbox folder
              <input id="setDropboxFolder" type="text" placeholder="/HA-Backups" />
            </label>
            <label>Gotify URL
              <input id="setGotifyUrl" type="text" placeholder="http://10.0.0.99:8091" />
            </label>
            <label>Gotify token
              <input id="setGotifyToken" type="password" placeholder="token" />
            </label>
          </div>
          <div class="actions">
            <button id="saveSettings" class="btn primary">Save Settings</button>
            <button id="testDropbox" class="btn ghost">Test Dropbox</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Logs -->
    <section id="tab-logs" class="tabpanel" role="tabpanel">
      <div class="card">
        <div class="card-head"><h2>Recent Activity</h2></div>
        <pre id="logView" class="log"></pre>
      </div>
    </section>
  </main>

  <!-- Modal -->
  <dialog id="modal" class="modal">
    <div class="modal-card">
      <div class="modal-head">
        <h3 id="modalTitle">Confirm</h3>
        <button id="modalClose" class="icon">&times;</button>
      </div>
      <div id="modalBody" class="modal-body"></div>
      <div class="modal-actions">
        <button id="modalCancel" class="btn ghost">Cancel</button>
        <button id="modalOk" class="btn primary">OK</button>
      </div>
    </div>
  </dialog>

  <template id="tpl-table">
    <table><thead></thead><tbody></tbody></table>
  </template>

  <script src="app.js"></script>
</body>
</html>
