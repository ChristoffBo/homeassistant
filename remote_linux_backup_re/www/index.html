<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Remote Linux Backup ‚Äî Control Panel</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">üóÇÔ∏è</div>
      <div>
        <div class="title">Remote Linux Backup</div>
        <div class="subtitle">From ‚Üí To ‚Ä¢ Backups ‚Ä¢ Restores ‚Ä¢ Scheduler</div>
      </div>
    </div>
    <div class="status-area">
      <span id="apiStatus" class="status-dot offline" title="API status"></span>
      <span id="capNote" class="badge"></span>
      <button id="refreshBtn" class="btn ghost">Refresh</button>
    </div>
  </header>

  <main class="container">
    <nav class="tabs" role="tablist" aria-label="Main">
      <button class="tab active" data-tab="backup">Backup</button>
      <button class="tab" data-tab="restore">Restore</button>
      <button class="tab" data-tab="scheduler">Scheduler</button>
      <button class="tab" data-tab="shares">Storage</button>
      <button class="tab" data-tab="servers">Servers</button>
      <button class="tab" data-tab="logs">Logs</button>
    </nav>

    <!-- Backup -->
    <section id="tab-backup" class="tabpanel active">
      <div class="grid two">
        <div class="card">
          <div class="card-head"><h2>Source (From)</h2></div>
          <div class="form-grid">
            <label>Server
              <select id="bkSrcHost"></select>
            </label>
            <label>Type
              <select id="bkType">
                <option value="rsync">Folder / Files</option>
                <option value="dd">Full disk image</option>
              </select>
            </label>
            <label>Path / Device
              <div class="row">
                <input id="bkSrcPath" type="text" placeholder="/etc or /dev/sda" class="grow"/>
                <button id="bkBrowseSrc" class="btn ghost hidden">Browse</button>
              </div>
            </label>
            <label>Compression
              <select id="bkCompression">
                <option value="auto">Auto</option>
                <option value="gzip">gzip</option>
                <option value="xz">xz</option>
                <option value="none">None</option>
              </select>
            </label>
          </div>
        </div>

        <div class="card">
          <div class="card-head"><h2>Destination (To)</h2></div>
          <div class="form-grid">
            <label>Destination type
              <select id="bkDestType">
                <option value="path">Direct path</option>
                <option value="share">Mapped Share</option>
                <option value="dropbox">Dropbox</option>
              </select>
            </label>

            <div id="bkShareWrap" class="hidden">
              <label>Share
                <select id="bkShare"></select>
              </label>
              <label>Folder in share
                <div class="row">
                  <input id="bkShareSubpath" type="text" placeholder="/server1" class="grow"/>
                  <button id="bkShareBrowse" class="btn ghost hidden">Browse</button>
                </div>
              </label>
              <div class="row">
                <span id="bkShareStatus" class="badge">Unknown</span>
                <button id="bkShareConnect" class="btn">Connect</button>
              </div>
            </div>

            <label id="bkDestPathWrap">Direct path
              <input id="bkDestPath" type="text" placeholder="/data/backups" />
            </label>

            <div id="bkDropboxWrap" class="row hidden">
              <input id="bkDropboxFolder" class="grow" type="text" placeholder="/HA-Backups" />
              <button id="bkPickDropbox" class="btn ghost hidden">Pick</button>
            </div>

            <label>Name (optional)
              <input id="bkName" type="text" placeholder="auto if empty" />
            </label>
          </div>
          <div class="actions"><button id="startBackup" class="btn primary">Start Backup</button></div>
        </div>
      </div>

      <div class="card">
        <div class="card-head"><h2>Backups</h2></div>
        <div id="backupsTable" class="table"></div>
      </div>
    </section>

    <!-- Restore -->
    <section id="tab-restore" class="tabpanel">
      <div class="card">
        <div class="card-head"><h2>Restore</h2></div>
        <div class="form-grid three">
          <label>Backup
            <select id="rsBackupSelect"></select>
          </label>
          <label>Server (To)
            <select id="rsTargetHost"></select>
          </label>
          <label>Path / Device
            <div class="row">
              <input id="rsTargetPath" type="text" placeholder="/restore/path or /dev/sda" class="grow"/>
              <button id="rsBrowseTarget" class="btn ghost hidden">Browse</button>
            </div>
          </label>
        </div>
        <div class="actions"><button id="startRestore" class="btn danger">Start Restore</button></div>
      </div>
    </section>

    <!-- Scheduler -->
    <section id="tab-scheduler" class="tabpanel">
      <div class="grid two">
        <div class="card">
          <div class="card-head"><h2>Create Job</h2></div>
          <div class="form-grid two">
            <label>Name
              <input id="scName" type="text" placeholder="weekly-server1-home"/>
            </label>
            <label>Type
              <select id="scType">
                <option value="rsync">Folder / Files</option>
                <option value="dd">Full disk image</option>
              </select>
            </label>
            <label>Source server
              <select id="scSrcHost"></select>
            </label>
            <label>Source path / device
              <div class="row">
                <input id="scSrcPath" type="text" placeholder="/home or /dev/sda" class="grow"/>
                <button id="scBrowseSrc" class="btn ghost hidden">Browse</button>
              </div>
            </label>
            <label>Destination
              <select id="scDestType">
                <option value="path">Direct path</option>
                <option value="share">Mapped Share</option>
                <option value="dropbox">Dropbox</option>
              </select>
            </label>

            <div id="scShareWrap" class="hidden">
              <label>Share
                <select id="scShare"></select>
              </label>
              <label>Folder in share
                <div class="row">
                  <input id="scShareSubpath" type="text" placeholder="/server1" class="grow"/>
                  <button id="scShareBrowse" class="btn ghost hidden">Browse</button>
                </div>
              </label>
            </div>

            <label id="scDestPathLabel">Direct path
              <input id="scDestPath" type="text" placeholder="/mnt/nas/backups/server1"/>
            </label>

            <div id="scDropboxWrap" class="row hidden">
              <input id="scDropboxFolder" class="grow" type="text" placeholder="/HA-Backups"/>
              <button id="scPickDropbox" class="btn ghost hidden">Pick</button>
            </div>
          </div>

          <div class="divider"></div>

          <div class="form-grid three">
            <label>Schedule
              <select id="scMode">
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
                <option value="once">One time</option>
                <option value="cron">Cron</option>
              </select>
            </label>
            <label id="scWeeklyWrap">Weekday
              <select id="scWeekday">
                <option value="0">Sun</option><option value="1">Mon</option><option value="2">Tue</option>
                <option value="3">Wed</option><option value="4">Thu</option><option value="5">Fri</option><option value="6">Sat</option>
              </select>
            </label>
            <label id="scMonthlyWrap">Month day
              <input id="scMonthday" type="number" min="1" max="31" value="1" />
            </label>
            <label id="scTimeWrap">Time
              <input id="scTime" type="time" value="02:00" />
            </label>
            <label id="scOnceWrap" class="hidden">Date/time
              <input id="scOnceDateTime" type="datetime-local" />
            </label>
            <label id="scCronWrap" class="hidden">Cron
              <input id="scCron" type="text" placeholder="0 2 * * 6" />
            </label>
          </div>
          <div class="actions"><button id="scCreate" class="btn primary">Create Job</button></div>
        </div>

        <div class="card">
          <div class="card-head"><h2>Jobs</h2></div>
          <div id="jobsTable" class="table"></div>
        </div>
      </div>
    </section>

    <!-- Storage -->
    <section id="tab-shares" class="tabpanel">
      <div class="grid two">
        <div class="card">
          <div class="card-head"><h2>Map a Share</h2></div>
          <div class="form-grid two">
            <label>Name <input id="shName" type="text" placeholder="NAS_Backups"/></label>
            <label>Type
              <select id="shType">
                <option value="smb">SMB</option>
                <option value="nfs">NFS</option>
                <option value="local">Local</option>
              </select>
            </label>
            <label>Server / Export <input id="shServer" type="text" placeholder="10.0.0.5 or nfs-server:/export"/></label>
            <label>Share (SMB) <input id="shShare" type="text" placeholder="Backups"/></label>
            <label>Mount point (addon) <input id="shMount" type="text" placeholder="/mnt/shares/backups"/></label>
            <label>Local path (Local) <input id="shLocal" type="text" placeholder="/mnt/data/backups"/></label>
            <label>User (SMB) <input id="shUser" type="text"/></label>
            <label>Password (SMB) <input id="shPass" type="password"/></label>
          </div>
          <div class="actions">
            <button id="shAdd" class="btn">Save</button>
            <button id="shConnect" class="btn">Connect</button>
            <button id="shDisconnect" class="btn ghost">Disconnect</button>
            <button id="shTest" class="btn ghost">Test</button>
          </div>
        </div>

        <div class="card">
          <div class="card-head"><h2>Shares</h2></div>
          <div id="sharesTable" class="table"></div>
        </div>
      </div>
    </section>

    <!-- Servers -->
    <section id="tab-servers" class="tabpanel">
      <div class="card">
        <div class="card-head"><h2>Servers</h2></div>
        <div class="form-grid three">
          <label>Label <input id="hLabel" type="text" placeholder="Server 1"/></label>
          <label>Address <input id="hAddr" type="text" placeholder="10.0.0.10"/></label>
          <label>User <input id="hUser" type="text" placeholder="root"/></label>
          <label>Password <input id="hPass" type="password"/></label>
          <label>Default path <input id="hPath" type="text" placeholder="/mnt/data"/></label>
          <div class="actions">
            <button id="hAdd" class="btn">Save</button>
            <button id="hTest" class="btn ghost">Test SSH</button>
          </div>
        </div>
        <div id="hostsTable" class="table"></div>
      </div>
    </section>

    <!-- Logs -->
    <section id="tab-logs" class="tabpanel">
      <div class="card">
        <div class="card-head"><h2>Recent Activity</h2></div>
        <pre id="logView" class="log"></pre>
      </div>
    </section>
  </main>

  <!-- Picker modal -->
  <dialog id="picker" class="modal">
    <div class="modal-card">
      <div class="modal-head">
        <h3 id="pickerTitle">Browse</h3>
        <button id="pickerClose" class="icon">&times;</button>
      </div>
      <div class="modal-body">
        <div class="row">
          <input id="pickerPath" class="grow" type="text" />
          <button id="pickerUp" class="btn ghost">Up</button>
          <button id="pickerRefresh" class="btn ghost">Refresh</button>
        </div>
        <div id="pickerList" class="table" style="margin-top:8px"></div>
        <div id="pickerSupport" class="badge"></div>
      </div>
      <div class="modal-actions">
        <button id="pickerCancel" class="btn ghost">Cancel</button>
        <button id="pickerSelect" class="btn primary">Select</button>
      </div>
    </div>
  </dialog>

  <template id="tpl-table">
    <table><thead></thead><tbody></tbody></table>
  </template>

  <script src="app.js"></script>
</body>
</html>
