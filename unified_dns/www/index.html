<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Unified DNS</title>
<link rel="stylesheet" href="style.css">
</head>
<body class="theme-dark">
<header class="app-hdr">
  <h1>Unified DNS</h1>
  <p>Manual sync • Soft-color stats • Gotify • Self-Check</p>
  <nav class="tabs">
    <a href="#" class="tab-link active" data-tab="tab-dash">Dashboard</a>
    <a href="#" class="tab-link" data-tab="tab-sync">Sync</a>
    <a href="#" class="tab-link" data-tab="tab-notify">Notify</a>
    <a href="#" class="tab-link" data-tab="tab-settings">Settings</a>
    <a href="#" class="tab-link" data-tab="tab-self">Self-Check</a>
    <a href="#" class="tab-link" data-tab="tab-logs">Logs</a>
  </nav>
</header>

<main>
  <!-- Dashboard -->
  <section id="tab-dash" class="tab active">
    <div class="row">
      <label>Refresh every
        <select id="refresh-every">
          <option value="2">2</option>
          <option value="5" selected>5</option>
          <option value="10">10</option>
          <option value="20">20</option>
        </select> sec
      </label>
      <button id="btn-update-now" type="button" class="btn">Update now</button>
    </div>
    <div class="kpis">
      <div class="kpi"><div class="kpi-t">Total</div><div id="kpi-total" class="kpi-v">0</div></div>
      <div class="kpi kpi-red"><div class="kpi-t">Blocked</div><div id="kpi-blocked" class="kpi-v">0</div></div>
      <div class="kpi kpi-green"><div class="kpi-t">Allowed</div><div id="kpi-allowed" class="kpi-v">0</div></div>
      <div class="kpi"><div class="kpi-t">% Blocked</div><div id="kpi-pct" class="kpi-v">0%</div></div>
      <div class="kpi"><div class="kpi-t">Busiest</div><div id="kpi-busiest" class="kpi-v">n/a</div></div>
    </div>
    <h3>Servers</h3>
    <table id="tbl-servers" class="tbl">
      <thead><tr><th>Server</th><th>Type</th><th>Status</th><th>Total</th><th>Allowed</th><th>Blocked</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Sync (placeholder for now) -->
  <section id="tab-sync" class="tab">
    <p>Manual sync controls appear here (disabled until servers configured).</p>
  </section>

  <!-- Notify -->
  <section id="tab-notify" class="tab">
    <h3>Gotify</h3>
    <label>URL <input id="opt-gotify-url" type="text" inputmode="url" autocomplete="off"></label>
    <label>Token <input id="opt-gotify-token" type="text" autocomplete="off"></label>
    <button id="btn-save-notify" type="button" class="btn">Save</button>
  </section>

  <!-- Settings -->
  <section id="tab-settings" class="tab">
    <h3>Add / Update Server</h3>
    <div class="form-grid">
      <label>Display Name <input id="srv-name" type="text" autocomplete="off"></label>
      <label>Type
        <select id="srv-type">
          <option value="technitium" selected>Technitium</option>
          <option value="adguard">AdGuard Home</option>
          <option value="pihole">Pi-hole</option>
        </select>
      </label>
      <label>Base URL <input id="srv-base" type="text" placeholder="http://10.0.0.10:5380"></label>
      <label>DNS Host (optional) <input id="srv-dnshost" type="text" placeholder="10.0.0.10"></label>
      <label>DNS Port <input id="srv-dnsport" type="number" value="53" min="1" max="65535"></label>
      <label>DNS Protocol
        <select id="srv-dnsproto">
          <option value="udp" selected>udp</option>
          <option value="tcp">tcp</option>
        </select>
      </label>
      <label>Username <input id="srv-user" type="text" autocomplete="off"></label>
      <label>Password <input id="srv-pass" type="password" autocomplete="new-password"></label>
      <label>Token <input id="srv-token" type="text" autocomplete="off"></label>
      <label class="chk"><input id="srv-verify" type="checkbox" checked> Verify TLS</label>
      <label class="chk"><input id="srv-primary" type="checkbox"> Primary</label>
    </div>
    <div class="row">
      <button id="btn-save-server" type="button" class="btn">Save/Update Server</button>
      <button id="btn-clear-form" type="button" class="btn btn-secondary">Clear</button>
    </div>

    <h3>Configured Servers</h3>
    <table id="tbl-configured" class="tbl">
      <thead><tr><th>Name</th><th>Type</th><th>URL</th><th>Primary</th><th>Actions</th></tr></thead>
      <tbody></tbody>
    </table>

    <h3>Cache Builder (Global)</h3>
    <textarea id="opt-cache-global" rows="6"></textarea>
    <div class="row"><button id="btn-save-cache" type="button" class="btn">Save</button></div>
  </section>

  <!-- Self-Check -->
  <section id="tab-self" class="tab">
    <div class="row">
      <button id="btn-selfcheck" type="button" class="btn">Run self-check</button>
    </div>
    <pre id="selfcheck-output" class="box"></pre>
  </section>

  <!-- Logs (placeholder) -->
  <section id="tab-logs" class="tab">
    <p>See Add-on log for backend details.</p>
  </section>
</main>

<div id="toast" class="toast"></div>
<script src="app.js"></script>
</body>
</html>